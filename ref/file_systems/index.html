
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>FileSystems - renameit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#filesystems" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="renameit" class="md-header__button md-logo" aria-label="renameit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            renameit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              FileSystems
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="renameit" class="md-nav__button md-logo" aria-label="renameit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    renameit
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        Core
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          FileSystems
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        FileSystems
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#renameit.file_systems.aws.FileSystemAwsS3" class="md-nav__link">
    FileSystemAwsS3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#renameit.file_systems.azure.FileSystemAzureDatalakeStorage" class="md-nav__link">
    FileSystemAzureDatalakeStorage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#renameit.file_systems.google.FileSystemGoogleCloudStorage" class="md-nav__link">
    FileSystemGoogleCloudStorage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#renameit.file_systems.local.FileSystemLocal" class="md-nav__link">
    FileSystemLocal
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../handlers/" class="md-nav__link">
        Handlers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#renameit.file_systems.aws.FileSystemAwsS3" class="md-nav__link">
    FileSystemAwsS3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#renameit.file_systems.azure.FileSystemAzureDatalakeStorage" class="md-nav__link">
    FileSystemAzureDatalakeStorage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#renameit.file_systems.google.FileSystemGoogleCloudStorage" class="md-nav__link">
    FileSystemGoogleCloudStorage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#renameit.file_systems.local.FileSystemLocal" class="md-nav__link">
    FileSystemLocal
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="filesystems">FileSystems<a class="headerlink" href="#filesystems" title="Permanent link">#</a></h1>


<div class="doc doc-object doc-class">



<h2 id="renameit.file_systems.aws.FileSystemAwsS3" class="doc doc-heading">
        <code>FileSystemAwsS3</code>


<a href="#renameit.file_systems.aws.FileSystemAwsS3" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents first">

  
      <p>Manage files on aws s3.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>source_bucket</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Name of bucket that contains the original files.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_bucket</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Name of bucket that should contain the new files.
If bucket does not already exist an error will be raised, it will not
be created automatically. Defaults to be the same as source_bucket.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>source_dir</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Directory path from where to start looking for files.
If not provided defaults to source_bucket root.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>target_dir</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Directory path to where should the new files be written.
If not provided defaults to target_bucket root.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>recursive</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Decides whether to look for files recursively.
Defaults to True.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>aws_access_key_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The access key to use when creating
the s3 resource. If not provided, the credentials configured for the session
will be used.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>aws_secret_access_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The secret key to use when creating
the s3 resource. Same semantics as aws_access_key_id above.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>region_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The name of the region associated with the resource.
If not provided, it will be obtained from the default boto3 session.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>renameit/file_systems/aws.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileSystemAwsS3</span><span class="p">(</span><span class="n">IFileSystem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Manage files on aws s3.</span>

<span class="sd">    Args:</span>
<span class="sd">        source_bucket (str): Name of bucket that contains the original files.</span>
<span class="sd">        target_bucket (str, optional): Name of bucket that should contain the new files.</span>
<span class="sd">            If bucket does not already exist an error will be raised, it will not</span>
<span class="sd">            be created automatically. Defaults to be the same as source_bucket.</span>
<span class="sd">        source_dir (str, optional): Directory path from where to start looking for files.</span>
<span class="sd">            If not provided defaults to source_bucket root.</span>
<span class="sd">        target_dir (str, optional): Directory path to where should the new files be written.</span>
<span class="sd">            If not provided defaults to target_bucket root.</span>
<span class="sd">        recursive (bool, optional): Decides whether to look for files recursively.</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">        aws_access_key_id (str, optional): The access key to use when creating</span>
<span class="sd">            the s3 resource. If not provided, the credentials configured for the session</span>
<span class="sd">            will be used.</span>
<span class="sd">        aws_secret_access_key (str, optional): The secret key to use when creating</span>
<span class="sd">            the s3 resource. Same semantics as aws_access_key_id above.</span>
<span class="sd">        region_name (str, optional):  The name of the region associated with the resource.</span>
<span class="sd">            If not provided, it will be obtained from the default boto3 session.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;aws_s3&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">source_bucket</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">target_bucket</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">source_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">target_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">aws_access_key_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">aws_secret_access_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">region_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">source_bucket</span> <span class="o">=</span> <span class="n">source_bucket</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_bucket</span> <span class="o">=</span> <span class="n">target_bucket</span> <span class="ow">or</span> <span class="n">source_bucket</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">=</span> <span class="n">source_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">target_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span> <span class="o">=</span> <span class="n">recursive</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aws_access_key_id</span> <span class="o">=</span> <span class="n">aws_access_key_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aws_secret_access_key</span> <span class="o">=</span> <span class="n">aws_secret_access_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region_name</span> <span class="o">=</span> <span class="n">region_name</span> <span class="ow">or</span> <span class="n">boto3</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span><span class="o">.</span><span class="n">region_name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span>
            <span class="s2">&quot;s3&quot;</span><span class="p">,</span>
            <span class="n">aws_access_key_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aws_access_key_id</span><span class="p">,</span>
            <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aws_secret_access_key</span><span class="p">,</span>
            <span class="n">region_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">region_name</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">client</span>

        <span class="c1"># TODO try to create it with the same configs as source_bucket</span>
        <span class="c1"># or using some user input.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_bucket</span><span class="p">)</span><span class="o">.</span><span class="n">creation_date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TargetContainerNotExistError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Target bucket `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_bucket</span><span class="si">}</span><span class="s2">` does not exist &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;or you do not have enough permissions to access it.&quot;</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">source_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source_dir</span>

    <span class="nd">@source_dir</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">source_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_source_dir</span> <span class="o">=</span> <span class="n">add_slash</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">target_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target_dir</span>

    <span class="nd">@target_dir</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">target_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_target_dir</span> <span class="o">=</span> <span class="n">add_slash</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">list_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">FileObject</span><span class="p">]:</span>
        <span class="n">continuation_token</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Bucket&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_bucket</span><span class="p">,</span>
            <span class="s2">&quot;Prefix&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span><span class="p">,</span>
            <span class="s2">&quot;StartAfter&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># This will group all subdirectories in the response&#39;s CommonPrefixes</span>
        <span class="c1"># thus, their files will not be included in the reponse&#39;s Content.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;Delimiter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">continuation_token</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ContinuationToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">continuation_token</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_client</span><span class="o">.</span><span class="n">list_objects_v2</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;Contents&quot;</span><span class="p">]:</span>
                <span class="k">yield</span> <span class="n">FileObject</span><span class="p">(</span>
                    <span class="n">path</span><span class="o">=</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span><span class="p">),</span>
                    <span class="n">modified_date</span><span class="o">=</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;LastModified&quot;</span><span class="p">],</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;IsTruncated&quot;</span><span class="p">]:</span>
                <span class="n">continuation_token</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;NextContinuationToken&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

    <span class="k">def</span> <span class="nf">copy_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">,</span> <span class="n">target_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">+</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">+</span> <span class="n">target_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="n">copy_source</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Bucket&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_bucket</span><span class="p">,</span> <span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">+</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">path</span><span class="p">}</span>
        <span class="n">s3_target_bucket</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_bucket</span><span class="p">)</span>
        <span class="n">s3_target_bucket</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">copy_source</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">+</span> <span class="n">target_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="renameit.file_systems.azure.FileSystemAzureDatalakeStorage" class="doc doc-heading">
        <code>FileSystemAzureDatalakeStorage</code>


<a href="#renameit.file_systems.azure.FileSystemAzureDatalakeStorage" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents first">

  
      <p>Manage files on azure datalake storage gen2.</p>

<details class="supports-multiple-authentication-methods">
  <summary>Supports multiple authentication methods</summary>
  <ul>
<li>Storage account name and access keys</li>
<li>Storage account connection strings</li>
<li>Service principal with RBAC assignments</li>
</ul>
</details>
  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>source_container</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Name of storage account container with the original files.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_container</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Name of storage account container that should contain new files.
Defaults to be the same as source_container and it will be created automatically if it
doesn't exist.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>source_dir</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Directory path from where to start looking for files.
If not provided defaults to source_container root.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>target_dir</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Directory path to where should the new files be written.
If not provided defaults to target_container root.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>secure_transfer</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to use https or not. Uses https by default.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>recursive</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether Decides whether to look for files recursively.
Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>connection_string</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The storage account connection string.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>storage_account_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Storage account name.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>storage_account_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Storage account access key.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>tenant_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Directory (tenant) ID of the service principal (app).</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>client_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Application (client) ID of the service principal (app).</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>client_secret</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The app password that it uses to authenticate itself.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>account_url</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Provided if the storage account was behind a custom
domain name. Defaults to <protocol>://<storage_account_name>.dfs.core.windows.net.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>renameit/file_systems/azure.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileSystemAzureDatalakeStorage</span><span class="p">(</span><span class="n">IFileSystem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Manage files on azure datalake storage gen2.</span>

<span class="sd">    Supports multiple authentication methods:</span>

<span class="sd">      - Storage account name and access keys</span>
<span class="sd">      - Storage account connection strings</span>
<span class="sd">      - Service principal with RBAC assignments</span>

<span class="sd">    Args:</span>
<span class="sd">        source_container (str): Name of storage account container with the original files.</span>
<span class="sd">        target_container (str): Name of storage account container that should contain new files.</span>
<span class="sd">            Defaults to be the same as source_container and it will be created automatically if it</span>
<span class="sd">            doesn&#39;t exist.</span>
<span class="sd">        source_dir (str, optional): Directory path from where to start looking for files.</span>
<span class="sd">            If not provided defaults to source_container root.</span>
<span class="sd">        target_dir (str, optional): Directory path to where should the new files be written.</span>
<span class="sd">            If not provided defaults to target_container root.</span>
<span class="sd">        secure_transfer (bool, optional): Whether to use https or not. Uses https by default.</span>
<span class="sd">        recursive (bool, optional): Whether Decides whether to look for files recursively.</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">        connection_string (str, optional): The storage account connection string.</span>
<span class="sd">        storage_account_name (str, optional): Storage account name.</span>
<span class="sd">        storage_account_key (str, optional): Storage account access key.</span>
<span class="sd">        tenant_id (str, optional): Directory (tenant) ID of the service principal (app).</span>
<span class="sd">        client_id (str, optional): Application (client) ID of the service principal (app).</span>
<span class="sd">        client_secret (str, optional): The app password that it uses to authenticate itself.</span>
<span class="sd">        account_url (str, optional): Provided if the storage account was behind a custom</span>
<span class="sd">            domain name. Defaults to &lt;protocol&gt;://&lt;storage_account_name&gt;.dfs.core.windows.net.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;azure_datalake_storage&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">source_container</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">target_container</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">source_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">target_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">secure_transfer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">connection_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">storage_account_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">storage_account_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tenant_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">client_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">account_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">source_container</span> <span class="o">=</span> <span class="n">source_container</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_container</span> <span class="o">=</span> <span class="n">target_container</span> <span class="ow">or</span> <span class="n">source_container</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">=</span> <span class="n">source_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">target_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span> <span class="o">=</span> <span class="s2">&quot;https&quot;</span> <span class="k">if</span> <span class="n">secure_transfer</span> <span class="k">else</span> <span class="s2">&quot;http&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span> <span class="o">=</span> <span class="n">recursive</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connection_string</span> <span class="o">=</span> <span class="n">connection_string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage_account_name</span> <span class="o">=</span> <span class="n">storage_account_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage_account_key</span> <span class="o">=</span> <span class="n">storage_account_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tenant_id</span> <span class="o">=</span> <span class="n">tenant_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="n">client_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span> <span class="o">=</span> <span class="n">client_secret</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">account_url</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">account_url</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="si">}</span><span class="s2">://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">storage_account_name</span><span class="si">}</span><span class="s2">.dfs.core.windows.net&quot;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">service_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_service_client</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_file_system_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_client</span><span class="o">.</span><span class="n">get_file_system_client</span><span class="p">(</span>
            <span class="n">file_system</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">source_container</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_file_system_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_client</span><span class="o">.</span><span class="n">get_file_system_client</span><span class="p">(</span>
            <span class="n">file_system</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">target_container</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_file_system_client</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">target_file_system_client</span><span class="o">.</span><span class="n">create_file_system</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_service_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLakeServiceClient</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection_string</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DataLakeServiceClient</span><span class="o">.</span><span class="n">from_connection_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_string</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_account_name</span><span class="p">:</span>

            <span class="n">credential</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ClientSecretCredential</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_account_key</span><span class="p">:</span>
                <span class="n">credential</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_account_key</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tenant_id</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span><span class="p">:</span>
                <span class="n">credential</span> <span class="o">=</span> <span class="n">ClientSecretCredential</span><span class="p">(</span>
                    <span class="n">tenant_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tenant_id</span><span class="p">,</span>
                    <span class="n">client_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
                    <span class="n">client_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_secret</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Not enough credentials provided in order to connect to azure storage service.&quot;</span>
                <span class="p">)</span>

            <span class="k">return</span> <span class="n">DataLakeServiceClient</span><span class="p">(</span><span class="n">account_url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">account_url</span><span class="p">,</span> <span class="n">credential</span><span class="o">=</span><span class="n">credential</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either &#39;connection_string&#39; or &#39;storage_account_name&#39; is required.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">list_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">FileObject</span><span class="p">]:</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_file_system_client</span><span class="o">.</span><span class="n">get_paths</span><span class="p">(</span>
            <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_directory</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">FileObject</span><span class="p">(</span>
                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="n">add_slash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span><span class="p">)),</span>
                    <span class="n">modified_date</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">last_modified</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">rename_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">,</span> <span class="n">target_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Renaming: &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">account_url</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">source_container</span><span class="si">}</span><span class="s2">/&quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">add_slash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span><span class="p">)</span><span class="si">}{</span><span class="n">source_obj</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot; to &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">account_url</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_container</span><span class="si">}</span><span class="s2">/&quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">add_slash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span><span class="p">)</span><span class="si">}{</span><span class="n">target_obj</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">full_target_path</span> <span class="o">=</span> <span class="n">add_slash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span><span class="p">)</span> <span class="o">+</span> <span class="n">target_obj</span><span class="o">.</span><span class="n">path</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">target_file_system_client</span><span class="o">.</span><span class="n">create_file</span><span class="p">(</span><span class="n">full_target_path</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">source_file_system_client</span><span class="o">.</span><span class="n">get_file_client</span><span class="p">(</span>
            <span class="n">file_path</span><span class="o">=</span><span class="n">add_slash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span><span class="p">)</span> <span class="o">+</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">path</span>
        <span class="p">)</span><span class="o">.</span><span class="n">rename_file</span><span class="p">(</span><span class="n">new_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">target_container</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">full_target_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="renameit.file_systems.google.FileSystemGoogleCloudStorage" class="doc doc-heading">
        <code>FileSystemGoogleCloudStorage</code>


<a href="#renameit.file_systems.google.FileSystemGoogleCloudStorage" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents first">

  
      <p>Manage files on google cloud storage.</p>
<p>Authenticating to google cloud storage uses service account credentials
and looks for them in the following ordered places:</p>
<ul>
<li>Checks <code>service_account_json</code> argument</li>
<li>Checks <code>service_account_info</code> argument</li>
<li>Environment variable called <code>GOOGLE_APPLICATION_CREDENTIALS</code>
    that points to json file that contains the credentials</li>
</ul>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>source_bucket</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Name of bucket that contains the original files.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_bucket</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Name of bucket that should contain the new files.
If bucket does not already exist an error will be raised, it will not
be created automatically. Defaults to be the same as source_bucket.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>source_dir</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Directory path from where to start looking for files.
If not provided defaults to source_bucket root.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>target_dir</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Directory path to where should the new files be written.
If not provided defaults to target_bucket root.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>recursive</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Decides whether to look for files recursively.
Defaults to True.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>service_account_json</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>File path to json file that contains service
account credentials.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>service_account_info</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Dict">Dict</span>[str, str], str]</code>
          </td>
          <td><p>Service account
credentials as dict or a string representing a json object.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>renameit/file_systems/google.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileSystemGoogleCloudStorage</span><span class="p">(</span><span class="n">IFileSystem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Manage files on google cloud storage.</span>

<span class="sd">    Authenticating to google cloud storage uses service account credentials</span>
<span class="sd">    and looks for them in the following ordered places:</span>

<span class="sd">    - Checks `service_account_json` argument</span>
<span class="sd">    - Checks `service_account_info` argument</span>
<span class="sd">    - Environment variable called `GOOGLE_APPLICATION_CREDENTIALS`</span>
<span class="sd">        that points to json file that contains the credentials</span>

<span class="sd">    Args:</span>
<span class="sd">        source_bucket (str): Name of bucket that contains the original files.</span>
<span class="sd">        target_bucket (str): Name of bucket that should contain the new files.</span>
<span class="sd">            If bucket does not already exist an error will be raised, it will not</span>
<span class="sd">            be created automatically. Defaults to be the same as source_bucket.</span>
<span class="sd">        source_dir (str, optional): Directory path from where to start looking for files.</span>
<span class="sd">            If not provided defaults to source_bucket root.</span>
<span class="sd">        target_dir (str, optional): Directory path to where should the new files be written.</span>
<span class="sd">            If not provided defaults to target_bucket root.</span>
<span class="sd">        recursive (bool, optional): Decides whether to look for files recursively.</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">        service_account_json (str, optional): File path to json file that contains service</span>
<span class="sd">            account credentials.</span>
<span class="sd">        service_account_info (Union[Dict[str, str], str], optional): Service account</span>
<span class="sd">            credentials as dict or a string representing a json object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;google_cloud_storage&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">source_bucket</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">target_bucket</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">source_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">target_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">service_account_json</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">service_account_info</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_bucket</span> <span class="o">=</span> <span class="n">source_bucket</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_bucket</span> <span class="o">=</span> <span class="n">target_bucket</span> <span class="ow">or</span> <span class="n">source_bucket</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">=</span> <span class="n">source_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">target_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span> <span class="o">=</span> <span class="n">recursive</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service_account_json</span> <span class="o">=</span> <span class="n">service_account_json</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service_account_info</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">service_account_info</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">service_account_info</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span>
            <span class="k">else</span> <span class="n">service_account_info</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_account_json</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_service_account_json</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_account_json</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_account_info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storage_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_service_account_info</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_account_info</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">source_bucket_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_client</span><span class="o">.</span><span class="n">bucket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_bucket</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_bucket_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_client</span><span class="o">.</span><span class="n">bucket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_bucket</span><span class="p">)</span>

        <span class="c1"># TODO try to create it with the same configs as source_bucket</span>
        <span class="c1"># or using some user input.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_bucket_client</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">TargetContainerNotExistError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Target bucket `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_bucket</span><span class="si">}</span><span class="s2">` does not exist &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;or you do not have enough permissions to access it.&quot;</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">source_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source_dir</span>

    <span class="nd">@source_dir</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">source_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_source_dir</span> <span class="o">=</span> <span class="n">add_slash</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">target_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target_dir</span>

    <span class="nd">@target_dir</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">target_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_target_dir</span> <span class="o">=</span> <span class="n">add_slash</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">list_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">FileObject</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">:</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span>

        <span class="n">blobs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_client</span><span class="o">.</span><span class="n">list_blobs</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">source_bucket</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">blob</span> <span class="ow">in</span> <span class="n">blobs</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">blob</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">FileObject</span><span class="p">(</span>
                    <span class="n">path</span><span class="o">=</span><span class="n">blob</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span><span class="p">),</span> <span class="n">modified_date</span><span class="o">=</span><span class="n">blob</span><span class="o">.</span><span class="n">updated</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">,</span> <span class="n">target_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">source_blob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_bucket_client</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">+</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="n">target_blob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_bucket_client</span><span class="o">.</span><span class="n">copy_blob</span><span class="p">(</span>
            <span class="n">source_blob</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_bucket_client</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">+</span> <span class="n">target_obj</span><span class="o">.</span><span class="n">path</span>
        <span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Copied: &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;blob </span><span class="si">{</span><span class="n">source_blob</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> in bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">source_bucket</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;to blob </span><span class="si">{</span><span class="n">target_blob</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> in bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_bucket</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">rename_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">,</span> <span class="n">target_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_bucket</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_bucket</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rename_within_same_bucket</span><span class="p">(</span><span class="n">source_obj</span><span class="p">,</span> <span class="n">target_obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rename_across_different_buckets</span><span class="p">(</span><span class="n">source_obj</span><span class="p">,</span> <span class="n">target_obj</span><span class="p">)</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Renamed: &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;blob </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">+</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2"> in bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">source_bucket</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;to blob </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">+</span> <span class="n">target_obj</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2"> in bucket </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_bucket</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_rename_within_same_bucket</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">,</span> <span class="n">target_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">source_blob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_bucket_client</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">+</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_bucket_client</span><span class="o">.</span><span class="n">rename_blob</span><span class="p">(</span><span class="n">source_blob</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">+</span> <span class="n">target_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_rename_across_different_buckets</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">source_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">,</span> <span class="n">target_obj</span><span class="p">:</span> <span class="n">FileObject</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copy_object</span><span class="p">(</span><span class="n">source_obj</span><span class="p">,</span> <span class="n">target_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_bucket_client</span><span class="o">.</span><span class="n">delete_blob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">+</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="renameit.file_systems.local.FileSystemLocal" class="doc doc-heading">
        <code>FileSystemLocal</code>


<a href="#renameit.file_systems.local.FileSystemLocal" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents first">

  
      <p>Manage files on the local operating system.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>source_dir</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Source directory to iterate files from.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_dir</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Target directory to copy/rename files to.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>recursive</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Decides if listing source_dir should be recursive or not.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>renameit/file_systems/local.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileSystemLocal</span><span class="p">(</span><span class="n">IFileSystem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Manage files on the local operating system.</span>

<span class="sd">    Args:</span>
<span class="sd">        source_dir (str): Source directory to iterate files from.</span>
<span class="sd">        target_dir (str): Target directory to copy/rename files to.</span>
<span class="sd">        recursive (bool, optional): Decides if listing source_dir should be recursive or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;local&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">source_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">target_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span> <span class="o">=</span> <span class="n">recursive</span>

    <span class="k">def</span> <span class="nf">list_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">FileObject</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">:</span>
            <span class="n">glob_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span><span class="o">.</span><span class="n">rglob</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">glob_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span><span class="o">.</span><span class="n">glob</span>

        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">glob_method</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
                <span class="k">yield</span> <span class="n">FileObject</span><span class="p">(</span>
                    <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span><span class="p">)),</span>
                    <span class="n">modified_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">((</span><span class="n">path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">)),</span>
                <span class="p">)</span>

    <span class="nd">@_create_target_dirs</span>
    <span class="k">def</span> <span class="nf">rename_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">,</span> <span class="n">target_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Renaming: &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">/</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; to &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">/</span> <span class="n">target_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">/</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">/</span> <span class="n">target_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

    <span class="nd">@_create_target_dirs</span>
    <span class="k">def</span> <span class="nf">copy_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">,</span> <span class="n">target_obj</span><span class="p">:</span> <span class="n">FileObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Copying: &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">/</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; to &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">/</span> <span class="n">target_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">/</span> <span class="n">source_obj</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_dir</span> <span class="o">/</span> <span class="n">target_obj</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../core/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Core" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Core
            </div>
          </div>
        </a>
      
      
        
        <a href="../handlers/" class="md-footer__link md-footer__link--next" aria-label="Next: Handlers" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Handlers
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>